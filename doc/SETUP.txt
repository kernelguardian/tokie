TOKIE - OTP RETRIEVAL EXTENSION FOR RAYCAST
============================================

INSTALLATION
------------

1. Clone or download this repository
2. Navigate to the extension directory
3. Run: npm install
4. Run: npm run dev
5. The extension will appear in Raycast

CONFIGURATION
-------------

Open Raycast Preferences > Extensions > Tokie to configure:

  Enable/Disable Sources
  ----------------------
  - iMessage/SMS: Toggle to enable reading OTPs from Messages
  - Gmail: Toggle to enable reading OTPs from Gmail
  - iCloud Mail: Toggle to enable reading OTPs from iCloud Mail

  Behavior Options
  ----------------
  - Mark as Read: Automatically mark emails as read after copying OTP
  - Auto Delete: Automatically delete emails after copying OTP
  - Lookback Period: How many minutes back to search for OTPs (default: 10)


SOURCE-SPECIFIC SETUP
---------------------

iMessage/SMS
~~~~~~~~~~~~
Requirements:
  - Full Disk Access permission for Raycast
  - Grant via: System Settings > Privacy & Security > Full Disk Access > Add Raycast

Notes:
  - Reads directly from local Messages database
  - No mark-as-read or delete functionality (not supported by macOS)
  - Works with both iMessage and SMS messages


Gmail
~~~~~
Requirements:
  - Google Cloud Console project with Gmail API enabled
  - OAuth 2.0 Client ID (Desktop application type)

Setup Steps:
  1. Go to console.cloud.google.com
  2. Create a new project or select existing
  3. Enable the Gmail API
  4. Create OAuth 2.0 credentials:
     - Application type: Desktop app
     - Download the client ID
  5. Enter the Client ID in Tokie preferences
  6. On first use, authorize the extension to access Gmail

Required Scopes:
  - gmail.readonly (read emails)
  - gmail.modify (mark as read, delete)


iCloud Mail
~~~~~~~~~~~
Requirements:
  - iCloud email address
  - App-specific password (NOT your Apple ID password)

Setup Steps:
  1. Go to appleid.apple.com
  2. Sign in with your Apple ID
  3. Navigate to Security > App-Specific Passwords
  4. Generate a new password for "Tokie"
  5. Enter your iCloud email and the app password in Tokie preferences

Notes:
  - Uses IMAP connection to imap.mail.me.com
  - Supports mark-as-read and delete functionality


USAGE
-----

1. Open Raycast
2. Type "List OTPs" or search for "Tokie"
3. View recent OTPs from all enabled sources
4. Press Enter to copy the OTP code to clipboard
5. Use Cmd+Shift+P to paste directly

Actions available:
  - Copy OTP: Copies code to clipboard (concealed, not in clipboard history)
  - Paste OTP: Pastes code into frontmost application
  - Mark as Read: Mark the source email as read (Gmail/iCloud only)
  - Delete Message: Delete the source email (Gmail/iCloud only)
  - Refresh: Reload OTPs from all sources
  - Open Preferences: Configure extension settings


SECURITY NOTES
--------------

  - OTPs are never stored on disk; only held in memory during session
  - Gmail tokens are stored securely by Raycast's OAuth system
  - iCloud app passwords should be unique to this extension
  - Clipboard copies are marked as concealed (hidden from clipboard history)
  - No data is sent to external servers (except to Gmail/iCloud APIs)


TROUBLESHOOTING
---------------

"No OTPs Found"
  - Check that at least one source is enabled
  - Verify the lookback period is long enough
  - Ensure required permissions/credentials are configured

iMessage not working
  - Grant Full Disk Access to Raycast in System Settings
  - Restart Raycast after granting permission

Gmail not working
  - Verify OAuth Client ID is correctly entered
  - Re-authorize if prompted
  - Check that Gmail API is enabled in Google Cloud Console

iCloud not working
  - Verify email address is correct
  - Regenerate app-specific password
  - Ensure 2FA is enabled on your Apple ID


DEVELOPMENT
-----------

Build: npm run build
Lint: npm run lint
Fix lint: npm run fix-lint
Publish: npm run publish

Before Publishing:
  - Change "author" in package.json to your Raycast Store username
  - The author must be a registered Raycast developer account
  - Create an account at raycast.com if you don't have one


ICON CUSTOMIZATION
------------------

The extension uses placeholder icons located in assets/:
  - extension-icon.png (512x512 for store listing)
  - gmail-icon.png (64x64 for list items)
  - icloud-icon.png (64x64 for list items)
  - imessage-icon.png (64x64 for list items)

Replace with custom icons as needed. Extension icon must be 512x512 PNG.
